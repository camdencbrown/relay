{
  "sql": "SELECT p.category, COUNT(DISTINCT s.sale_id) as total_sales, SUM(s.quantity) as total_quantity, ROUND(SUM(p.price * s.quantity), 2) as revenue, ROUND(SUM(p.cost * s.quantity), 2) as total_cost, ROUND(SUM((p.price - p.cost) * s.quantity), 2) as profit, ROUND(AVG(p.profit_margin), 2) as avg_profit_margin FROM products p INNER JOIN sales s ON p.product_id = s.product_id GROUP BY p.category ORDER BY profit DESC",
  "pipelines": ["pipe-27b2eec1", "pipe-1d3a22d2"]
}
